"""CSV file created using Matlab code. Want to alter the created CSV using this code

Create second sheet in CSV with following Headings: TMS (Y/N), TTL, Pulse Number, Timestamp, Time
Create third sheet in CSV with following Headings: TMS (Y/N), Pulse Number, Time

Need to figure out how to alter the time values in the CSV BEFORE running this code to alter the CSV
Need to figure out how to determine the time from the initial start value
Need to figure out how to add the created dataframes to the CSV as new sheets. Some code below"""

import csv
import pandas as pd

tmsFile='/Users/ashleypelton/Downloads/timing-rest-8blocks-60-101723 - Sheet1.csv'

sheet_name='All Values'
sheet_name='Relevant Values'

TMSColumn = []
TTL = []
PulseNumber = []
TimeStamp = []
Time = []

pulse = 0

with open(tmsFile, mode='r') as file:
    reader = csv.reader(file)
    for row in reader:
        for i in range(len(row)):
            if row[i] == 'Timestamp:':
                if i + 1 < len(row):
                    TimeStamp.append(row[i+1])
            elif row[i] == 'TTL:':
                if i + 1 < len(row):
                    TTL.append(row[i + 1])
                    PulseNumber.append(pulse)
                    pulse += 1

            if row[i] == 'TMS:':
                if i + 1 < len(row):
                    TMSColumn.append('Y')
                    TTL.append(' ')
                    PulseNumber.append(pulse)
                    pulse += 1
            else:
                TMSColumn.append('N')

print(PulseNumber)

data = { 'TMS (Y/N)' : [],
         'TTL' : [],
         'Pulse Number' : [],
         'Timestamp' : [],
         'Time' : []}
df = pd.DataFrame(data)

updatedData = { 'TMS (Y/N)' : [],
                'Pulse Number' : [],
                'Time' : []}
updatedDf = pd.DataFrame(updatedData)

"""Need to figure out how to add these data frames to different sheets!"""
"""with pd.ExcelWriter(tmsFile, engine='openpyxl', mode='a') as writer:
    df.to_excel(writer, sheet_name='All Values', index=False)

with pd.ExcelWriter(tmsFile, engine='openpyxl', mode='a') as writer:
    updatedDf.to_excel(writer, sheet_name='Relevant Values', index=False)"""